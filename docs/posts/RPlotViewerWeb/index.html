<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.262">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yousuf Ali">
<meta name="dcterms.date" content="2025-12-25">

<title>Yousuf Ali - Building a Web-Based R Plot Viewer with ASP.NET Core MVC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Yousuf Ali</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Yousuf28"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Building a Web-Based R Plot Viewer with ASP.NET Core MVC</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">vibe-coding</div>
                <div class="quarto-category">ASP.NET</div>
                <div class="quarto-category">R</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yousuf Ali </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 25, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#table-of-contents" id="toc-table-of-contents" class="nav-link" data-scroll-target="#table-of-contents">Table of Contents</a></li>
  <li><a href="#architecture-overview" id="toc-architecture-overview" class="nav-link" data-scroll-target="#architecture-overview">Architecture Overview</a></li>
  <li><a href="#project-structure" id="toc-project-structure" class="nav-link" data-scroll-target="#project-structure">Project Structure</a></li>
  <li><a href="#core-components" id="toc-core-components" class="nav-link" data-scroll-target="#core-components">Core Components</a>
  <ul class="collapse">
  <li><a href="#program.cs---application-entry-point" id="toc-program.cs---application-entry-point" class="nav-link" data-scroll-target="#program.cs---application-entry-point">1. <strong>Program.cs</strong> - Application Entry Point</a></li>
  <li><a href="#plotcontroller.cs---request-handler" id="toc-plotcontroller.cs---request-handler" class="nav-link" data-scroll-target="#plotcontroller.cs---request-handler">2. <strong>PlotController.cs</strong> - Request Handler</a></li>
  <li><a href="#rplotservice.cs---r-integration-service" id="toc-rplotservice.cs---r-integration-service" class="nav-link" data-scroll-target="#rplotservice.cs---r-integration-service">3. <strong>RPlotService.cs</strong> - R Integration Service</a></li>
  <li><a href="#create_plots.r---r-plotting-script" id="toc-create_plots.r---r-plotting-script" class="nav-link" data-scroll-target="#create_plots.r---r-plotting-script">4. <strong>create_plots.R</strong> - R Plotting Script</a></li>
  <li><a href="#index.cshtml---user-interface" id="toc-index.cshtml---user-interface" class="nav-link" data-scroll-target="#index.cshtml---user-interface">5. <strong>Index.cshtml</strong> - User Interface</a></li>
  </ul></li>
  <li><a href="#file-dependencies" id="toc-file-dependencies" class="nav-link" data-scroll-target="#file-dependencies">File Dependencies</a>
  <ul class="collapse">
  <li><a href="#dependency-graph" id="toc-dependency-graph" class="nav-link" data-scroll-target="#dependency-graph">Dependency Graph</a></li>
  <li><a href="#runtime-dependencies" id="toc-runtime-dependencies" class="nav-link" data-scroll-target="#runtime-dependencies">Runtime Dependencies</a></li>
  </ul></li>
  <li><a href="#complete-workflow" id="toc-complete-workflow" class="nav-link" data-scroll-target="#complete-workflow">Complete Workflow</a>
  <ul class="collapse">
  <li><a href="#step-by-step-generating-a-bar-chart" id="toc-step-by-step-generating-a-bar-chart" class="nav-link" data-scroll-target="#step-by-step-generating-a-bar-chart">Step-by-Step: Generating a Bar Chart</a></li>
  </ul></li>
  <li><a href="#how-everything-connects" id="toc-how-everything-connects" class="nav-link" data-scroll-target="#how-everything-connects">How Everything Connects</a>
  <ul class="collapse">
  <li><a href="#data-flow-diagram" id="toc-data-flow-diagram" class="nav-link" data-scroll-target="#data-flow-diagram">Data Flow Diagram</a></li>
  </ul></li>
  <li><a href="#key-design-decisions" id="toc-key-design-decisions" class="nav-link" data-scroll-target="#key-design-decisions">Key Design Decisions</a>
  <ul class="collapse">
  <li><a href="#why-singleton-for-rplotservice" id="toc-why-singleton-for-rplotservice" class="nav-link" data-scroll-target="#why-singleton-for-rplotservice">1. <strong>Why Singleton for RPlotService?</strong></a></li>
  <li><a href="#why-store-plots-in-wwwroot" id="toc-why-store-plots-in-wwwroot" class="nav-link" data-scroll-target="#why-store-plots-in-wwwroot">2. <strong>Why Store Plots in wwwroot/?</strong></a></li>
  <li><a href="#why-use-process.start-instead-of-r.net" id="toc-why-use-process.start-instead-of-r.net" class="nav-link" data-scroll-target="#why-use-process.start-instead-of-r.net">3. <strong>Why Use Process.Start() Instead of R.NET?</strong></a></li>
  <li><a href="#why-asyncawait-for-r-execution" id="toc-why-asyncawait-for-r-execution" class="nav-link" data-scroll-target="#why-asyncawait-for-r-execution">4. <strong>Why Async/Await for R Execution?</strong></a></li>
  <li><a href="#why-standalone-html-in-index.cshtml" id="toc-why-standalone-html-in-index.cshtml" class="nav-link" data-scroll-target="#why-standalone-html-in-index.cshtml">5. <strong>Why Standalone HTML in Index.cshtml?</strong></a></li>
  </ul></li>
  <li><a href="#security-considerations" id="toc-security-considerations" class="nav-link" data-scroll-target="#security-considerations">Security Considerations</a>
  <ul class="collapse">
  <li><a href="#input-validation" id="toc-input-validation" class="nav-link" data-scroll-target="#input-validation">1. <strong>Input Validation</strong></a></li>
  <li><a href="#file-path-sanitization" id="toc-file-path-sanitization" class="nav-link" data-scroll-target="#file-path-sanitization">2. <strong>File Path Sanitization</strong></a></li>
  <li><a href="#automatic-cleanup" id="toc-automatic-cleanup" class="nav-link" data-scroll-target="#automatic-cleanup">3. <strong>Automatic Cleanup</strong></a></li>
  </ul></li>
  <li><a href="#extending-the-application" id="toc-extending-the-application" class="nav-link" data-scroll-target="#extending-the-application">Extending the Application</a>
  <ul class="collapse">
  <li><a href="#adding-new-plot-types" id="toc-adding-new-plot-types" class="nav-link" data-scroll-target="#adding-new-plot-types">Adding New Plot Types</a></li>
  <li><a href="#adding-custom-datasets" id="toc-adding-custom-datasets" class="nav-link" data-scroll-target="#adding-custom-datasets">Adding Custom Datasets</a></li>
  </ul></li>
  <li><a href="#performance-optimization" id="toc-performance-optimization" class="nav-link" data-scroll-target="#performance-optimization">Performance Optimization</a>
  <ul class="collapse">
  <li><a href="#caching-generated-plots" id="toc-caching-generated-plots" class="nav-link" data-scroll-target="#caching-generated-plots">1. <strong>Caching Generated Plots</strong></a></li>
  <li><a href="#background-processing" id="toc-background-processing" class="nav-link" data-scroll-target="#background-processing">2. <strong>Background Processing</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources">Additional Resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This blog post walks through the architecture and workflow of <strong>RPlotViewerWeb</strong>, a web application that generates statistical plots using R’s ggplot2 library and displays them in a browser. We’ll explore how ASP.NET Core MVC integrates with R, the file dependencies, and the complete request-response workflow.</p>
<hr>
</section>
<section id="table-of-contents" class="level2">
<h2 class="anchored" data-anchor-id="table-of-contents">Table of Contents</h2>
<ol type="1">
<li><a href="#architecture-overview">Architecture Overview</a></li>
<li><a href="#project-structure">Project Structure</a></li>
<li><a href="#core-components">Core Components</a></li>
<li><a href="#file-dependencies">File Dependencies</a></li>
<li><a href="#complete-workflow">Complete Workflow</a></li>
<li><a href="#how-everything-connects">How Everything Connects</a></li>
<li><a href="#key-design-decisions">Key Design Decisions</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
<hr>
</section>
<section id="architecture-overview" class="level2">
<h2 class="anchored" data-anchor-id="architecture-overview">Architecture Overview</h2>
<p>The application follows the <strong>Model-View-Controller (MVC)</strong> pattern with an additional <strong>Service Layer</strong> for business logic. Here’s the high-level architecture:</p>
<pre><code>┌─────────────┐
│   Browser   │
│  (Client)   │
└──────┬──────┘
       │ HTTP Request
       ▼
┌─────────────────────────────────┐
│   ASP.NET Core Web Server       │
│  ┌──────────────────────────┐   │
│  │   PlotController         │   │ ◄── Controller Layer
│  └───────────┬──────────────┘   │
│              │                  │
│  ┌───────────▼──────────────┐   │
│  │   RPlotService           │   │ ◄── Service Layer
│  └───────────┬──────────────┘   │
│              │                  │
└──────────────┼──────────────────┘
               │ Process.Start()
               ▼
┌─────────────────────────────────┐
│   R-Portable                    │
│  ┌──────────────────────────┐   │
│  │   Rscript.exe            │   │ ◄── R Runtime
│  └───────────┬──────────────┘   │
│              │                  │
│  ┌───────────▼──────────────┐   │
│  │   create_plots.R         │   │ ◄── R Script
│  └───────────┬──────────────┘   │
│              │                  │
└──────────────┼──────────────────┘
               │ ggsave()
               ▼
┌─────────────────────────────────┐
│   wwwroot/plots/                │
│   plot_bar_20251225.png         │ ◄── Generated Plot
└─────────────────────────────────┘</code></pre>
<hr>
</section>
<section id="project-structure" class="level2">
<h2 class="anchored" data-anchor-id="project-structure">Project Structure</h2>
<pre><code>RPlotViewerWeb/
├── Controllers/
│   └── PlotController.cs          # Handles HTTP requests
├── Services/
│   └── RPlotService.cs            # R integration logic
├── Views/
│   ├── Plot/
│   │   └── Index.cshtml           # Main UI
│   └── Shared/
│       └── _Layout.cshtml         # Layout template
├── Resources/
│   ├── R-Portable/
│   │   └── bin/
│   │       └── Rscript.exe        # R executable
│   └── create_plots.R             # R plotting script
├── wwwroot/
│   ├── plots/                     # Generated plots (web-accessible)
│   └── css/                       # Static assets
├── Program.cs                     # Application entry point
└── RPlotViewerWeb.csproj          # Project configuration</code></pre>
<hr>
</section>
<section id="core-components" class="level2">
<h2 class="anchored" data-anchor-id="core-components">Core Components</h2>
<section id="program.cs---application-entry-point" class="level3">
<h3 class="anchored" data-anchor-id="program.cs---application-entry-point">1. <strong>Program.cs</strong> - Application Entry Point</h3>
<p><strong>Purpose:</strong> Configures and starts the web application.</p>
<p><strong>Key Responsibilities:</strong> - Registers services (dependency injection) - Configures middleware pipeline - Sets up routing</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> builder <span class="op">=</span> WebApplication<span class="op">.</span><span class="fu">CreateBuilder</span><span class="op">(</span>args<span class="op">);</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Register services</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>builder<span class="op">.</span><span class="fu">Services</span><span class="op">.</span><span class="fu">AddControllersWithViews</span><span class="op">();</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>builder<span class="op">.</span><span class="fu">Services</span><span class="op">.</span><span class="fu">AddSingleton</span><span class="op">&lt;</span>RPlotService<span class="op">&gt;();</span>  <span class="co">// ← Service registration</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> app <span class="op">=</span> builder<span class="op">.</span><span class="fu">Build</span><span class="op">();</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">// Middleware pipeline</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">UseStaticFiles</span><span class="op">();</span>      <span class="co">// Serves files from wwwroot/</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">UseRouting</span><span class="op">();</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">MapControllerRoute</span><span class="op">(</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    name<span class="op">:</span> <span class="st">"default"</span><span class="op">,</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    pattern<span class="op">:</span> <span class="st">"{controller=Plot}/{action=Index}/{id?}"</span><span class="op">);</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>app<span class="op">.</span><span class="fu">Run</span><span class="op">();</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Dependencies:</strong> - <code>RPlotService.cs</code> (registered as singleton) - Controllers (auto-discovered)</p>
<hr>
</section>
<section id="plotcontroller.cs---request-handler" class="level3">
<h3 class="anchored" data-anchor-id="plotcontroller.cs---request-handler">2. <strong>PlotController.cs</strong> - Request Handler</h3>
<p><strong>Purpose:</strong> Handles HTTP requests and coordinates between the view and service layer.</p>
<p><strong>Key Methods:</strong></p>
<section id="index---displays-the-ui" class="level4">
<h4 class="anchored" data-anchor-id="index---displays-the-ui"><code>Index()</code> - Displays the UI</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> IActionResult <span class="fu">Index</span><span class="op">()</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="fu">View</span><span class="op">();</span>  <span class="co">// Returns Views/Plot/Index.cshtml</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="generatestring-plottype---generates-plots" class="level4">
<h4 class="anchored" data-anchor-id="generatestring-plottype---generates-plots"><code>Generate(string plotType)</code> - Generates plots</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="op">[</span>HttpPost<span class="op">]</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> async Task<span class="op">&lt;</span>IActionResult<span class="op">&gt;</span> <span class="fu">Generate</span><span class="op">(</span><span class="dt">string</span> plotType<span class="op">)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> logs <span class="op">=</span> <span class="kw">new</span> <span class="fu">StringBuilder</span><span class="op">();</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Call service to generate plot</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> plotUrl <span class="op">=</span> await _plotService<span class="op">.</span><span class="fu">GeneratePlotAsync</span><span class="op">(</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        plotType<span class="op">,</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        msg <span class="op">=&gt;</span> logs<span class="op">.</span><span class="fu">AppendLine</span><span class="op">(</span>msg<span class="op">)</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Return JSON response</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> <span class="fu">Json</span><span class="op">(</span><span class="kw">new</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        success <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        plotUrl <span class="op">=</span> plotUrl<span class="op">,</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        logs <span class="op">=</span> logs<span class="op">.</span><span class="fu">ToString</span><span class="op">()</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">});</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Dependencies:</strong> - <code>RPlotService</code> (injected via constructor) - <code>Views/Plot/Index.cshtml</code> (rendered by Index action)</p>
<hr>
</section>
</section>
<section id="rplotservice.cs---r-integration-service" class="level3">
<h3 class="anchored" data-anchor-id="rplotservice.cs---r-integration-service">3. <strong>RPlotService.cs</strong> - R Integration Service</h3>
<p><strong>Purpose:</strong> Manages R process execution and file handling.</p>
<p><strong>Key Responsibilities:</strong> 1. Validates R installation paths 2. Executes R scripts via <code>Process.Start()</code> 3. Manages plot file storage 4. Cleans up old plots</p>
<p><strong>Constructor - Path Setup:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="fu">RPlotService</span><span class="op">(</span>IWebHostEnvironment environment<span class="op">)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> resourcesPath <span class="op">=</span> Path<span class="op">.</span><span class="fu">Combine</span><span class="op">(</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>        environment<span class="op">.</span><span class="fu">ContentRootPath</span><span class="op">,</span> <span class="st">"Resources"</span><span class="op">);</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    _rScriptPath <span class="op">=</span> Path<span class="op">.</span><span class="fu">Combine</span><span class="op">(</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        resourcesPath<span class="op">,</span> <span class="st">"R-Portable"</span><span class="op">,</span> <span class="st">"bin"</span><span class="op">,</span> <span class="st">"Rscript.exe"</span><span class="op">);</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    _createPlotsScriptPath <span class="op">=</span> Path<span class="op">.</span><span class="fu">Combine</span><span class="op">(</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        resourcesPath<span class="op">,</span> <span class="st">"create_plots.R"</span><span class="op">);</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    _outputDirectory <span class="op">=</span> Path<span class="op">.</span><span class="fu">Combine</span><span class="op">(</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        environment<span class="op">.</span><span class="fu">WebRootPath</span><span class="op">,</span> <span class="st">"plots"</span><span class="op">);</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ValidatePaths</span><span class="op">();</span>  <span class="co">// Ensures files exist</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Plot Generation:</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> async Task<span class="op">&lt;</span><span class="dt">string</span><span class="op">&gt;</span> <span class="fu">GeneratePlotAsync</span><span class="op">(</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">string</span> plotType<span class="op">,</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    Action<span class="op">&lt;</span><span class="dt">string</span><span class="op">&gt;?</span> logCallback <span class="op">=</span> <span class="kw">null</span><span class="op">)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> outputFileName <span class="op">=</span> $<span class="st">"plot_{plotType}_{DateTime.Now:yyyyMMdd_HHmmss}.png"</span><span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> outputFilePath <span class="op">=</span> Path<span class="op">.</span><span class="fu">Combine</span><span class="op">(</span>_outputDirectory<span class="op">,</span> outputFileName<span class="op">);</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Configure R process</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> processInfo <span class="op">=</span> <span class="kw">new</span> ProcessStartInfo</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        FileName <span class="op">=</span> _rScriptPath<span class="op">,</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        Arguments <span class="op">=</span> $<span class="st">"</span><span class="sc">\"</span><span class="st">{_createPlotsScriptPath}</span><span class="sc">\"</span><span class="st"> </span><span class="sc">\"</span><span class="st">{plotType}</span><span class="sc">\"</span><span class="st"> </span><span class="sc">\"</span><span class="st">{outputFilePath}</span><span class="sc">\"</span><span class="st">"</span><span class="op">,</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        RedirectStandardOutput <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        RedirectStandardError <span class="op">=</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        UseShellExecute <span class="op">=</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        CreateNoWindow <span class="op">=</span> <span class="kw">true</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Execute R script</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">using</span> <span class="dt">var</span> process <span class="op">=</span> Process<span class="op">.</span><span class="fu">Start</span><span class="op">(</span>processInfo<span class="op">);</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    await process<span class="op">.</span><span class="fu">WaitForExitAsync</span><span class="op">();</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Return web-accessible path</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> $<span class="st">"/plots/{outputFileName}"</span><span class="op">;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Dependencies:</strong> - <code>Resources/R-Portable/bin/Rscript.exe</code> - <code>Resources/create_plots.R</code> - <code>wwwroot/plots/</code> (output directory)</p>
<hr>
</section>
<section id="create_plots.r---r-plotting-script" class="level3">
<h3 class="anchored" data-anchor-id="create_plots.r---r-plotting-script">4. <strong>create_plots.R</strong> - R Plotting Script</h3>
<p><strong>Purpose:</strong> Creates ggplot2 visualizations and saves them as PNG files.</p>
<p><strong>Workflow:</strong> 1. Receives command-line arguments (plot type, output path) 2. Creates appropriate ggplot2 visualization 3. Saves plot using <code>ggsave()</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get arguments</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">commandArgs</span>(<span class="at">trailingOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>plot_type <span class="ot">&lt;-</span> args[<span class="dv">1</span>]</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>output_file <span class="ot">&lt;-</span> args[<span class="dv">2</span>]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot based on type</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (plot_type <span class="sc">==</span> <span class="st">"bar"</span>) {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Count of Vehicles by Class"</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (plot_type <span class="sc">==</span> <span class="st">"boxplot"</span>) {</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Highway MPG by Vehicle Class"</span>) <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> output_file,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> p,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">10</span>,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">6</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">150</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Dependencies:</strong> - R ggplot2 package - mpg dataset (included in ggplot2)</p>
<hr>
</section>
<section id="index.cshtml---user-interface" class="level3">
<h3 class="anchored" data-anchor-id="index.cshtml---user-interface">5. <strong>Index.cshtml</strong> - User Interface</h3>
<p><strong>Purpose:</strong> Provides the interactive web interface.</p>
<p><strong>Key Features:</strong> - Radio buttons for plot selection - Generate button with loading state - Plot display area - Collapsible log output</p>
<p><strong>JavaScript Workflow:</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>generateBtn<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">async</span> <span class="kw">function</span>() {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 1. Get selected plot type</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> plotType <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">'input[name="plotType"]:checked'</span>)<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 2. Show loading state</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    generateBtn<span class="op">.</span><span class="at">disabled</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    btnText<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">'Generating...'</span><span class="op">;</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 3. Call server endpoint</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="st">'/Plot/Generate'</span><span class="op">,</span> {</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">method</span><span class="op">:</span> <span class="st">'POST'</span><span class="op">,</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">headers</span><span class="op">:</span> { <span class="st">'Content-Type'</span><span class="op">:</span> <span class="st">'application/x-www-form-urlencoded'</span> }<span class="op">,</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">body</span><span class="op">:</span> <span class="vs">`plotType=</span><span class="sc">${</span>plotType<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 4. Display result</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> response<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (result<span class="op">.</span><span class="at">success</span>) {</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        plotArea<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`&lt;img src="</span><span class="sc">${</span>result<span class="op">.</span><span class="at">plotUrl</span><span class="sc">}</span><span class="vs">" class="img-fluid"&gt;`</span><span class="op">;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 5. Reset button state</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    generateBtn<span class="op">.</span><span class="at">disabled</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    btnText<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">'Generate Plot'</span><span class="op">;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Dependencies:</strong> - Bootstrap CSS (from CDN) - <code>/Plot/Generate</code> endpoint (PlotController)</p>
<hr>
</section>
</section>
<section id="file-dependencies" class="level2">
<h2 class="anchored" data-anchor-id="file-dependencies">File Dependencies</h2>
<section id="dependency-graph" class="level3">
<h3 class="anchored" data-anchor-id="dependency-graph">Dependency Graph</h3>
<pre><code>Program.cs
    ├── depends on → RPlotService.cs
    └── depends on → PlotController.cs

PlotController.cs
    ├── depends on → RPlotService.cs
    └── depends on → Views/Plot/Index.cshtml

RPlotService.cs
    ├── depends on → Resources/R-Portable/bin/Rscript.exe
    ├── depends on → Resources/create_plots.R
    └── depends on → wwwroot/plots/ (directory)

Views/Plot/Index.cshtml
    ├── depends on → /Plot/Generate (endpoint)
    └── depends on → Bootstrap CSS (CDN)

create_plots.R
    ├── depends on → ggplot2 package
    └── depends on → mpg dataset</code></pre>
</section>
<section id="runtime-dependencies" class="level3">
<h3 class="anchored" data-anchor-id="runtime-dependencies">Runtime Dependencies</h3>
<p><strong>At Application Startup:</strong> 1. <code>Program.cs</code> loads 2. <code>RPlotService</code> is instantiated (singleton) 3. <code>RPlotService</code> validates paths to R and scripts 4. Web server starts listening</p>
<p><strong>At Request Time:</strong> 1. Browser requests <code>/Plot/Index</code> 2. <code>PlotController.Index()</code> executes 3. <code>Index.cshtml</code> is rendered and sent to browser</p>
<p><strong>At Plot Generation:</strong> 1. JavaScript calls <code>/Plot/Generate</code> 2. <code>PlotController.Generate()</code> executes 3. <code>RPlotService.GeneratePlotAsync()</code> is called 4. R process is spawned 5. <code>create_plots.R</code> executes 6. PNG file is saved to <code>wwwroot/plots/</code> 7. File path is returned to browser 8. Browser displays image</p>
<hr>
</section>
</section>
<section id="complete-workflow" class="level2">
<h2 class="anchored" data-anchor-id="complete-workflow">Complete Workflow</h2>
<section id="step-by-step-generating-a-bar-chart" class="level3">
<h3 class="anchored" data-anchor-id="step-by-step-generating-a-bar-chart">Step-by-Step: Generating a Bar Chart</h3>
<section id="step-1-user-opens-application" class="level4">
<h4 class="anchored" data-anchor-id="step-1-user-opens-application"><strong>Step 1: User Opens Application</strong></h4>
<pre><code>Browser → GET http://localhost:5000/
    ↓
Program.cs (routing) → PlotController.Index()
    ↓
PlotController → return View()
    ↓
Views/Plot/Index.cshtml rendered
    ↓
HTML + JavaScript sent to browser</code></pre>
</section>
<section id="step-2-user-clicks-generate-plot" class="level4">
<h4 class="anchored" data-anchor-id="step-2-user-clicks-generate-plot"><strong>Step 2: User Clicks “Generate Plot”</strong></h4>
<p><strong>Client-Side (JavaScript):</strong></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 1. User clicks button</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>generateBtn<span class="op">.</span><span class="at">onclick</span> <span class="op">=</span> <span class="kw">async</span> <span class="kw">function</span>() {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 2. Prepare request</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> plotType <span class="op">=</span> <span class="st">'bar'</span><span class="op">;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 3. Send POST request</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> response <span class="op">=</span> <span class="cf">await</span> <span class="fu">fetch</span>(<span class="st">'/Plot/Generate'</span><span class="op">,</span> {</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">method</span><span class="op">:</span> <span class="st">'POST'</span><span class="op">,</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">body</span><span class="op">:</span> <span class="vs">`plotType=</span><span class="sc">${</span>plotType<span class="sc">}</span><span class="vs">`</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-3-server-processes-request" class="level4">
<h4 class="anchored" data-anchor-id="step-3-server-processes-request"><strong>Step 3: Server Processes Request</strong></h4>
<p><strong>Server-Side (C#):</strong></p>
<pre><code>Browser → POST /Plot/Generate?plotType=bar
    ↓
PlotController.Generate("bar")
    ↓
RPlotService.GeneratePlotAsync("bar", logCallback)
    ↓
Process.Start(Rscript.exe)
    ↓
Command: Rscript.exe "create_plots.R" "bar" "C:\...\wwwroot\plots\plot_bar_20251225.png"</code></pre>
</section>
<section id="step-4-r-executes" class="level4">
<h4 class="anchored" data-anchor-id="step-4-r-executes"><strong>Step 4: R Executes</strong></h4>
<p><strong>R Process:</strong></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. R receives arguments</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">commandArgs</span>(<span class="at">trailingOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># args[1] = "bar"</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># args[2] = "C:\...\wwwroot\plots\plot_bar_20251225.png"</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Create plot</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Count of Vehicles by Class"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Save to file</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> args[<span class="dv">2</span>], <span class="at">plot =</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-5-response-returns-to-browser" class="level4">
<h4 class="anchored" data-anchor-id="step-5-response-returns-to-browser"><strong>Step 5: Response Returns to Browser</strong></h4>
<p><strong>Server Response:</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"success"</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"plotUrl"</span><span class="fu">:</span> <span class="st">"/plots/plot_bar_20251225_143022.png"</span><span class="fu">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"logs"</span><span class="fu">:</span> <span class="st">"Generating bar plot...</span><span class="ch">\n</span><span class="st">[R OUTPUT] Creating plot type: bar</span><span class="ch">\n</span><span class="st">..."</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Client-Side Display:</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript code-with-copy"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">// 4. Receive response</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> response<span class="op">.</span><span class="fu">json</span>()<span class="op">;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">// 5. Display image</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plotArea<span class="op">.</span><span class="at">innerHTML</span> <span class="op">=</span> <span class="vs">`&lt;img src="</span><span class="sc">${</span>result<span class="op">.</span><span class="at">plotUrl</span><span class="sc">}</span><span class="vs">" class="img-fluid"&gt;`</span><span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">// Browser requests: GET /plots/plot_bar_20251225_143022.png</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-6-browser-displays-plot" class="level4">
<h4 class="anchored" data-anchor-id="step-6-browser-displays-plot"><strong>Step 6: Browser Displays Plot</strong></h4>
<pre><code>Browser → GET /plots/plot_bar_20251225_143022.png
    ↓
ASP.NET Core Static Files Middleware
    ↓
Serves file from wwwroot/plots/
    ↓
Image displayed in browser</code></pre>
<hr>
</section>
</section>
</section>
<section id="how-everything-connects" class="level2">
<h2 class="anchored" data-anchor-id="how-everything-connects">How Everything Connects</h2>
<section id="data-flow-diagram" class="level3">
<h3 class="anchored" data-anchor-id="data-flow-diagram">Data Flow Diagram</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                        Browser                              │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Index.cshtml (HTML + JavaScript)                    │   │
│  │  - Radio buttons (bar/boxplot)                       │   │
│  │  - Generate button                                   │   │
│  │  - Plot display area                                 │   │
│  └────────────┬─────────────────────────────────────────┘   │
└───────────────┼─────────────────────────────────────────────┘
                │
                │ POST /Plot/Generate
                │ plotType=bar
                ▼
┌─────────────────────────────────────────────────────────────┐
│                   ASP.NET Core Server                       │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  PlotController.cs                                   │   │
│  │  - Receives HTTP request                             │   │
│  │  - Calls RPlotService                                │   │
│  │  - Returns JSON response                             │   │
│  └────────────┬─────────────────────────────────────────┘   │
│               │                                             │
│               │ GeneratePlotAsync("bar")                    │
│               ▼                                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  RPlotService.cs                                     │   │
│  │  - Builds command: Rscript.exe create_plots.R bar    │   │
│  │  - Starts R process                                  │   │
│  │  - Waits for completion                              │   │
│  │  - Returns plot URL                                  │   │
│  └────────────┬─────────────────────────────────────────┘   │
└───────────────┼─────────────────────────────────────────────┘
                │
                │ Process.Start()
                ▼
┌─────────────────────────────────────────────────────────────┐
│                    R-Portable                               │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  Rscript.exe                                         │   │
│  │  - Executes create_plots.R                           │   │
│  └────────────┬─────────────────────────────────────────┘   │
│               │                                             │
│               │ source("create_plots.R")                    │
│               ▼                                             │
│  ┌──────────────────────────────────────────────────────┐   │
│  │  create_plots.R                                      │   │
│  │  - Loads ggplot2                                     │   │
│  │  - Creates bar chart                                 │   │
│  │  - Saves PNG file                                    │   │
│  └────────────┬─────────────────────────────────────────┘   │
└───────────────┼─────────────────────────────────────────────┘
                │
                │ ggsave("plot_bar_20251225.png")
                ▼
┌─────────────────────────────────────────────────────────────┐
│                    File System                              │
│  wwwroot/plots/plot_bar_20251225_143022.png                 │
└─────────────────────────────────────────────────────────────┘
                │
                │ GET /plots/plot_bar_20251225_143022.png
                ▼
┌─────────────────────────────────────────────────────────────┐
│              Static Files Middleware                        │
│  - Serves file from wwwroot/                                │
└─────────────────────────────────────────────────────────────┘
                │
                │ PNG image data
                ▼
┌─────────────────────────────────────────────────────────────┐
│                        Browser                              │
│  Displays plot image                                        │
└─────────────────────────────────────────────────────────────┘</code></pre>
<hr>
</section>
</section>
<section id="key-design-decisions" class="level2">
<h2 class="anchored" data-anchor-id="key-design-decisions">Key Design Decisions</h2>
<section id="why-singleton-for-rplotservice" class="level3">
<h3 class="anchored" data-anchor-id="why-singleton-for-rplotservice">1. <strong>Why Singleton for RPlotService?</strong></h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>builder<span class="op">.</span><span class="fu">Services</span><span class="op">.</span><span class="fu">AddSingleton</span><span class="op">&lt;</span>RPlotService<span class="op">&gt;();</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Reason:</strong> Path validation happens once at startup, not on every request. This improves performance and catches configuration errors early.</p>
</section>
<section id="why-store-plots-in-wwwroot" class="level3">
<h3 class="anchored" data-anchor-id="why-store-plots-in-wwwroot">2. <strong>Why Store Plots in wwwroot/?</strong></h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>_outputDirectory <span class="op">=</span> Path<span class="op">.</span><span class="fu">Combine</span><span class="op">(</span>environment<span class="op">.</span><span class="fu">WebRootPath</span><span class="op">,</span> <span class="st">"plots"</span><span class="op">);</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Reason:</strong> Files in <code>wwwroot/</code> are automatically served by ASP.NET Core’s static files middleware, making them accessible via URLs like <code>/plots/image.png</code>.</p>
</section>
<section id="why-use-process.start-instead-of-r.net" class="level3">
<h3 class="anchored" data-anchor-id="why-use-process.start-instead-of-r.net">3. <strong>Why Use Process.Start() Instead of R.NET?</strong></h3>
<p><strong>Reason:</strong> - Simpler setup (no additional NuGet packages) - Works with portable R installation - Clear separation between .NET and R code - Easier to debug R scripts independently</p>
</section>
<section id="why-asyncawait-for-r-execution" class="level3">
<h3 class="anchored" data-anchor-id="why-asyncawait-for-r-execution">4. <strong>Why Async/Await for R Execution?</strong></h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> async Task<span class="op">&lt;</span><span class="dt">string</span><span class="op">&gt;</span> <span class="fu">GeneratePlotAsync</span><span class="op">(...)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    await process<span class="op">.</span><span class="fu">WaitForExitAsync</span><span class="op">();</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Reason:</strong> R plot generation can take several seconds. Async execution prevents blocking the web server thread, allowing it to handle other requests.</p>
</section>
<section id="why-standalone-html-in-index.cshtml" class="level3">
<h3 class="anchored" data-anchor-id="why-standalone-html-in-index.cshtml">5. <strong>Why Standalone HTML in Index.cshtml?</strong></h3>
<p><strong>Reason:</strong> Including Bootstrap from CDN and embedding JavaScript directly simplifies deployment and reduces dependencies on local static files.</p>
<hr>
</section>
</section>
<section id="security-considerations" class="level2">
<h2 class="anchored" data-anchor-id="security-considerations">Security Considerations</h2>
<section id="input-validation" class="level3">
<h3 class="anchored" data-anchor-id="input-validation">1. <strong>Input Validation</strong></h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">// In create_plots.R</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">if</span> <span class="op">(</span>plot_type <span class="op">==</span> <span class="st">"bar"</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span>plot_type <span class="op">==</span> <span class="st">"boxplot"</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stop</span><span class="op">(</span><span class="fu">paste</span><span class="op">(</span><span class="st">"Unknown plot type:"</span><span class="op">,</span> plot_type<span class="op">))</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Only predefined plot types are allowed, preventing command injection.</p>
</section>
<section id="file-path-sanitization" class="level3">
<h3 class="anchored" data-anchor-id="file-path-sanitization">2. <strong>File Path Sanitization</strong></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> outputFileName <span class="op">=</span> $<span class="st">"plot_{plotType}_{DateTime.Now:yyyyMMdd_HHmmss}.png"</span><span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Filename is generated server-side, not from user input.</p>
</section>
<section id="automatic-cleanup" class="level3">
<h3 class="anchored" data-anchor-id="automatic-cleanup">3. <strong>Automatic Cleanup</strong></h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">void</span> <span class="fu">CleanupOldPlots</span><span class="op">(</span><span class="dt">int</span> hoursOld <span class="op">=</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Deletes plots older than 1 hour</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Prevents disk space exhaustion from accumulated plot files.</p>
<hr>
</section>
</section>
<section id="extending-the-application" class="level2">
<h2 class="anchored" data-anchor-id="extending-the-application">Extending the Application</h2>
<section id="adding-new-plot-types" class="level3">
<h3 class="anchored" data-anchor-id="adding-new-plot-types">Adding New Plot Types</h3>
<p><strong>1. Update create_plots.R:</strong></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## } else if (plot_type == "scatter") {</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mpg, <span class="fu">aes</span>(<span class="at">x =</span> displ, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Engine Displacement vs Highway MPG"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="do">## }</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>2. Update Index.cshtml:</strong></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div</span> <span class="er">class</span><span class="ot">=</span><span class="st">"form-check"</span><span class="kw">&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;input</span> <span class="er">class</span><span class="ot">=</span><span class="st">"form-check-input"</span> <span class="er">type</span><span class="ot">=</span><span class="st">"radio"</span> <span class="er">name</span><span class="ot">=</span><span class="st">"plotType"</span> <span class="er">id</span><span class="ot">=</span><span class="st">"scatterPlot"</span> <span class="er">value</span><span class="ot">=</span><span class="st">"scatter"</span><span class="kw">&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;label</span> <span class="er">class</span><span class="ot">=</span><span class="st">"form-check-label"</span> <span class="er">for</span><span class="ot">=</span><span class="st">"scatterPlot"</span><span class="kw">&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        📈 Scatter Plot - Displacement vs MPG</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;/label&gt;</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;/div&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>No changes needed in C# code!</p>
</section>
<section id="adding-custom-datasets" class="level3">
<h3 class="anchored" data-anchor-id="adding-custom-datasets">Adding Custom Datasets</h3>
<p><strong>1. Modify create_plots.R to accept data file:</strong></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>args <span class="ot">&lt;-</span> <span class="fu">commandArgs</span>(<span class="at">trailingOnly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plot_type <span class="ot">&lt;-</span> args[<span class="dv">1</span>]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> args[<span class="dv">2</span>]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>output_file <span class="ot">&lt;-</span> args[<span class="dv">3</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(data_file)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x_col, <span class="at">y =</span> y_col)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>2. Update RPlotService:</strong></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Arguments <span class="op">=</span> $<span class="st">"</span><span class="sc">\"</span><span class="st">{_createPlotsScriptPath}</span><span class="sc">\"</span><span class="st"> </span><span class="sc">\"</span><span class="st">{plotType}</span><span class="sc">\"</span><span class="st"> </span><span class="sc">\"</span><span class="st">{dataPath}</span><span class="sc">\"</span><span class="st"> </span><span class="sc">\"</span><span class="st">{outputFilePath}</span><span class="sc">\"</span><span class="st">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="performance-optimization" class="level2">
<h2 class="anchored" data-anchor-id="performance-optimization">Performance Optimization</h2>
<section id="caching-generated-plots" class="level3">
<h3 class="anchored" data-anchor-id="caching-generated-plots">1. <strong>Caching Generated Plots</strong></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="kw">static</span> Dictionary<span class="op">&lt;</span><span class="dt">string</span><span class="op">,</span> <span class="dt">string</span><span class="op">&gt;</span> _plotCache <span class="op">=</span> <span class="kw">new</span><span class="op">();</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> async Task<span class="op">&lt;</span><span class="dt">string</span><span class="op">&gt;</span> <span class="fu">GeneratePlotAsync</span><span class="op">(</span><span class="dt">string</span> plotType<span class="op">,</span> <span class="op">...)</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> cacheKey <span class="op">=</span> $<span class="st">"{plotType}_{DateTime.Now:yyyyMMdd}"</span><span class="op">;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">(</span>_plotCache<span class="op">.</span><span class="fu">ContainsKey</span><span class="op">(</span>cacheKey<span class="op">))</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        <span class="kw">return</span> _plotCache<span class="op">[</span>cacheKey<span class="op">];</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> plotUrl <span class="op">=</span> await <span class="fu">GenerateNewPlot</span><span class="op">(</span>plotType<span class="op">);</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    _plotCache<span class="op">[</span>cacheKey<span class="op">]</span> <span class="op">=</span> plotUrl<span class="op">;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> plotUrl<span class="op">;</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="background-processing" class="level3">
<h3 class="anchored" data-anchor-id="background-processing">2. <strong>Background Processing</strong></h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode csharp code-with-copy"><code class="sourceCode cs"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Use IHostedService for cleanup</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> PlotCleanupService <span class="op">:</span> BackgroundService</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="op">{</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">protected</span> <span class="kw">override</span> async Task <span class="fu">ExecuteAsync</span><span class="op">(</span>CancellationToken stoppingToken<span class="op">)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">while</span> <span class="op">(!</span>stoppingToken<span class="op">.</span><span class="fu">IsCancellationRequested</span><span class="op">)</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">{</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>            _plotService<span class="op">.</span><span class="fu">CleanupOldPlots</span><span class="op">();</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>            await Task<span class="op">.</span><span class="fu">Delay</span><span class="op">(</span>TimeSpan<span class="op">.</span><span class="fu">FromHours</span><span class="op">(</span><span class="dv">1</span><span class="op">),</span> stoppingToken<span class="op">);</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The RPlotViewerWeb application demonstrates a clean separation of concerns:</p>
<ul>
<li><strong>Program.cs</strong>: Application configuration</li>
<li><strong>PlotController</strong>: HTTP request handling</li>
<li><strong>RPlotService</strong>: R integration and file management</li>
<li><strong>create_plots.R</strong>: Statistical visualization logic</li>
<li><strong>Index.cshtml</strong>: User interface</li>
</ul>
<p>This architecture makes the application: - ✅ <strong>Maintainable</strong>: Each component has a single responsibility - ✅ <strong>Testable</strong>: Services can be mocked and tested independently - ✅ <strong>Extensible</strong>: New plot types require minimal changes - ✅ <strong>Scalable</strong>: Async operations prevent thread blocking</p>
<p>The key insight is treating R as an external service, communicating via process execution and file I/O, which provides a clean boundary between the .NET and R ecosystems.</p>
<hr>
</section>
<section id="additional-resources" class="level2">
<h2 class="anchored" data-anchor-id="additional-resources">Additional Resources</h2>
<ul>
<li><a href="https://docs.microsoft.com/aspnet/core/mvc">ASP.NET Core MVC Documentation</a></li>
<li><a href="https://ggplot2.tidyverse.org/">ggplot2 Documentation</a></li>
<li><a href="https://docs.microsoft.com/dotnet/api/system.diagnostics.process">Process Class in .NET</a></li>
</ul>
<hr>
<p><strong>GitHub Repository:</strong> - <a href="https://github.com/Yousuf28/RPlotViewerWeb">repo link</a></p>
<hr>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>